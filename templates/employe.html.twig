{# templates/employe.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Tableau de Bord Employé - Ecoride{% endblock %}

{% block body %}
<div class="container my-5">
    <h1 class="mb-4">Tableau de Bord Employé</h1>
    <p>Bienvenue dans votre espace de gestion. Vous pouvez ici modérer les avis et consulter les litiges.</p>

    <!-- Navigation par onglets mise à jour -->
    <ul class="nav nav-tabs" id="employeeTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="pending-tab" data-bs-toggle="tab" data-bs-target="#pending" type="button" role="tab" aria-controls="pending" aria-selected="true">
                <i class="bi bi-patch-check-fill me-2"></i>Avis en attente
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="disputes-tab" data-bs-toggle="tab" data-bs-target="#disputes" type="button" role="tab" aria-controls="disputes" aria-selected="false">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>Litiges en cours
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="rejected-tab" data-bs-toggle="tab" data-bs-target="#rejected" type="button" role="tab" aria-controls="rejected" aria-selected="false">
                <i class="bi bi-archive-fill me-2"></i>Historique des rejets
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="resolved-disputes-tab" data-bs-toggle="tab" data-bs-target="#resolved-disputes" type="button" role="tab" aria-controls="resolved-disputes" aria-selected="false">
                <i class="bi bi-check2-square me-2"></i>Historique des litiges
            </button>
        </li>
    </ul>

    <!-- Contenu des onglets -->
    <div class="tab-content" id="employeeTabContent">
        <!-- Onglet des Avis en Attente -->
        <div class="tab-pane fade show active" id="pending" role="tabpanel" aria-labelledby="pending-tab">
            <div class="card shadow-sm border-top-0 rounded-0 rounded-bottom"><div class="card-body" id="pending-reviews-container"><p id="no-pending-reviews" class="text-muted">Aucun nouvel avis à valider.</p></div></div>
        </div>

        <!-- Onglet des Litiges -->
        <div class="tab-pane fade" id="disputes" role="tabpanel" aria-labelledby="disputes-tab">
            <div class="card shadow-sm border-top-0 rounded-0 rounded-bottom"><div class="card-body" id="disputed-carpools-container"><p id="no-disputed-carpools" class="text-muted">Aucun litige en cours.</p></div></div>
        </div>

        <!-- Onglet de l'Historique des Rejets -->
        <div class="tab-pane fade" id="rejected" role="tabpanel" aria-labelledby="rejected-tab">
            <div class="card shadow-sm border-top-0 rounded-0 rounded-bottom"><div class="card-body" id="rejected-reviews-container"><p id="no-rejected-reviews" class="text-muted">Aucun avis n'a été rejeté.</p></div></div>
        </div>
        
        <!-- NOUVEL Onglet de l'Historique des Litiges -->
        <div class="tab-pane fade" id="resolved-disputes" role="tabpanel" aria-labelledby="resolved-disputes-tab">
            <div class="card shadow-sm border-top-0 rounded-0 rounded-bottom"><div class="card-body" id="resolved-disputes-container"><p id="no-resolved-disputes" class="text-muted">Aucun litige clôturé.</p></div></div>
        </div>
    </div>
</div>

<!-- Modale de confirmation pour le rejet d'avis -->
<div class="modal fade" id="rejectConfirmModal" tabindex="-1" aria-labelledby="rejectModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white"><h5 class="modal-title" id="rejectModalLabel">Confirmer le rejet</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button></div>
      <div class="modal-body">Êtes-vous sûr de vouloir rejeter cet avis ? Il sera déplacé dans l'historique et ne sera pas visible publiquement.</div>
      <div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button><button type="button" class="btn btn-danger" id="confirm-reject-btn">Oui, rejeter l'avis</button></div>
    </div>
  </div>
</div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/employee_dashboard.js') }}" defer></script>
{% endblock %}